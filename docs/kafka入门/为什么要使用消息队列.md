# 为什么要使用消息队列

## 消息队列是什么

消息队列是一种异步的服务间通信方式，适用于无服务器和微服务架构。消息在被处理和删除之前一直存储在队列上。每条消息仅可被一位用户处理一次。消息队列可被用于分离重量级处理、缓冲或批处理工作以及缓解高峰期工作负载。

## 消息队列的优缺点
### 解耦
可以降低应用之间的耦合性，假如系统A 需要调用系统B 发送短信，系统A 直接通过接口调用系统B，可能由于系统B 响应或者故障，导致系统A的性能变成，引入消息队列，系统A只需要把调用方式传递到消息队列中即可，不会导致A的整体性能变差。
### 削峰
削弱瞬时的请求高峰，让系统吞吐量在高峰请求下保持可控。

### 异步
应用程序间的异步通讯，先来说一下同步机制，HTTP请求就是同步操作，每发送一个HTTP 请求都需要等待服务器的响应，在等待过程中，连接是保持的（除非断开连接）。例如提交一个POST 请求提交数据，如果服务器卡顿，会导致响应延迟，对客户端的体验是非常差的，如果是异步，提交请求之后，服务器直接返回客户端结果，成功之后通知客户端提交成功。

### 系统可用性降低
系统可用性：系统服务不中断运行时间占实际运行时间的比例

系统引入的外部依赖越多，越容易挂掉。原来由一个系统解决的事情现在交由两个系统，假如由系统A的可用性为90% 及消息队列系统B 的可用性为90%
则系统的整体可用性=系统A 的可用性 * 消息队列的可用性 为90%*90%

### 系统复杂度提高
硬生生加个消息队列进来，你怎么保证消息没有重复消费？怎么处理消息丢失的情况？怎么解决消息积压的问题？怎么保证消息传递的顺序性？等等引入消息队列而产生的一系列问题。问题一堆，痛苦不已。

### 一致性问题
A 系统处理完了直接返回成功了，人都以为你这个请求就成功了；但是问题是，要是 BCD 三个系统那里，BD 两个系统写库成功了，结果 C 系统写库失败了，咋整？你这数据就不一致了。


## 为什么要使用消息队列
[为什么要使用消息队列](https://www.jianshu.com/p/11eaadd7ded4)

## kafka是什么
[apache-kafka](http://kafka.apache.org/)

[apache-kafka-chinese](http://kafka.apachecn.org/)

[apache-kafka-Github](https://github.com/apache/kafka)
kafka 属于分布式的消息引擎系统，主要功能是提供一套完备的消息发布与订阅解决方案。



